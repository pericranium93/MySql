-- Список сотрудников банка
create table if not exists users (
	id int unsigned not null auto_increment primary key comment "Идентификатор сотрудника",
	first_name varchar(100) not null comment "Имя сотрудника",
	last_name varchar(100) not null comment "Фамилия сотрудника",
	patronymic varchar(100) comment "Отчество сотрудника",
	department_id smallint unsigned not null comment "Код департамента/отдела",
	position_id tinyint unsigned not null comment "Код должности",
	current_employee bool default 1 comment "Признак трудосутройства",
	created_at datetime default current_timestamp comment "Время создания строки", 
	updated_at datetime default current_timestamp on update current_timestamp comment "Время обновления строки"
) comment "Сотрудники";

-- Список департаментов/отделов
create table if not exists departments (
	id smallint unsigned not null auto_increment primary key comment "Идентификатор департамента",
	name varchar(250) not null comment "Название департамента",
	is_active bool default 1 comment "Признак наличия в структуре организации",
	created_at datetime default current_timestamp comment "Время создания строки", 
	updated_at datetime default current_timestamp on update current_timestamp comment "Время обновления строки"
) comment "Департаменты";

-- Список должностей
create table if not exists positions (
	id tinyint unsigned not null auto_increment primary key comment "Идентификатор должности",
	name varchar(200) not null comment "Название должности",
	is_active bool default 1 comment "Признак наличия в текущем штатном расписании",
	created_at datetime default current_timestamp comment "Время создания строки", 
	updated_at datetime default current_timestamp on update current_timestamp comment "Время обновления строки"
) comment "Должности";

-- Список клиентов банка
create table if not exists clients (
	id serial primary key comment "Идентификатор клиента",
	first_name varchar(100) not null comment "Имя клиента",
	last_name varchar(100) not null comment "Фамилия клиента",
	patronymic varchar(100) comment "Отчество клиента",
	birthday date not null comment "Дата рождения",
	phone varchar(20) not null comment "Номер телефона", /*К номеру может быть привязано несколько клиентов*/
	created_at datetime default current_timestamp comment "Время создания строки", 
	updated_at datetime default current_timestamp on update current_timestamp comment "Время обновления строки"
) comment "Клиенты";

-- Таблица с детальной информацией о клиентах
create table if not exists clients_info (
	client_id bigint primary key comment "Идентификатор клиента",
	gender enum('M', 'F') comment "Гендер",
	citizenship_id tinyint unsigned not null comment "Гражданство",
	previous_first_name varchar(100) comment "Предыдущее имя",
	previous_last_name varchar(100) comment "Предыдущая фамилия",
	previous_patronymic varchar(100) comment "Предыдущее отчество",
	photo_id bigint unsigned not null unique comment "Фото клиента",
	passport_id bigint unsigned not null unique comment "Текущий паспорт клиента",
	home_phone_number varchar(20) comment "Домашний номер телефона",
	contact_person_phone_number varchar(20) comment "Номер телефона контактного лица",
	contact_person_name varchar(250) comment "Имя контактного лица",
	email varchar(100) comment "Электронная почта клиента",
	registration_address_id bigint unsigned comment "Идентфикатор адреса регистрации",
	residence_address_id bigint unsigned comment "Идентификатор адреса проживания",
	is_vip bool default 0 comment "Признак особого статуса",
	created_at datetime default current_timestamp comment "Время создания строки", 
	updated_at datetime default current_timestamp on update current_timestamp comment "Время обновления строки"
) comment "Клиенты";

-- Таблица с государствами (+ специальная графа "без гражданства")
create table if not exists citizenships (
	id tinyint unsigned not null auto_increment primary key comment "Идентификатор государства",
	name varchar(200) not null unique comment "Название государства",
	created_at datetime default current_timestamp comment "Время создания строки", 
	updated_at datetime default current_timestamp on update current_timestamp comment "Время обновления строки"
) comment "Гражданство";


-- Таблица паспортов
create table if not exists passports (
	id serial comment "Идентификатор паспорта",
	series_id smallint unsigned not null comment "Идентификатор серии",
	`number` mediumint unsigned not null comment "Номер паспорта", /* По идее приводить в надлежащий вид значения с 0 должно приложение */
	date_of_issue date not null comment "Дата выдачи",
	division_code_id smallint unsigned not null comment "Идентификатор кода подразделения",
	place_of_birth text not null comment "Место рождения",
	passport_photo_id bigint unsigned not null unique comment "Фото паспорта",
	registration_photo_id bigint unsigned not null unique comment "Фото страницы с регистрацией",
	is_valid bool default 1 comment "Признак действительности", /*Старые паспорта клиентов должны оставаться*/
	created_at datetime default current_timestamp comment "Время создания строки", 
	updated_at datetime default current_timestamp on update current_timestamp comment "Время обновления строки",
	primary key (series_id, `number`) comment "Составной ПК серия и номер паспорта"
) comment "Паспорта";

drop table passports;

-- Таблица с серией паспорта
create table if not exists series (
	id smallint unsigned not null auto_increment primary key comment "Идентификатор серии",
	series smallint unsigned not null unique comment "Серия паспорта",
	created_at datetime default current_timestamp comment "Время создания строки", 
	updated_at datetime default current_timestamp on update current_timestamp comment "Время обновления строки"
) comment "Гражданство";

-- Таблица с кодами подразделений и их наименованиями
create table if not exists division_codes (
	id smallint unsigned not null auto_increment primary key comment "Идентификатор кода подразделения",
	`number` varchar(10) not null unique comment "Код подразделения",
	name text not null comment "Название подразделения",
	created_at datetime default current_timestamp comment "Время создания строки", 
	updated_at datetime default current_timestamp on update current_timestamp comment "Время обновления строки"
) comment "Коды подразделений/наименование подразделений";

-- Таблица адресов
 create table if not exists adresses (
	id serial primary key comment "Идентификатор адреса",
	postcode_id smallint unsigned not null comment "Идентификатор индекса",
	street varchar(250) comment "Название улицы",
	house_number smallint unsigned not null comment "Номер дома",
	housing tinyint unsigned comment "Номер корпуса/строения",
	letter varchar(2) comment "Литера",
	flat smallint unsigned comment "Номер квартиры",
	created_at datetime default current_timestamp comment "Время создания строки", 
	updated_at datetime default current_timestamp on update current_timestamp comment "Время обновления строки"
) comment "Адреса";

-- Таблица с почтовыми индексами
create table if not exists postcodes (
	id smallint unsigned not null auto_increment primary key comment "Идентификатор индекса",
	postcode mediumint unsigned not null unique comment "Почтовый индекс", 
	locality_id smallint unsigned not null comment "Населённый пункт", 
	created_at datetime default current_timestamp comment "Время создания строки", 
	updated_at datetime default current_timestamp on update current_timestamp comment "Время обновления строки"
) comment "Почтовые индексы";

-- Таблица регионов
create table if not exists regions (
	id tinyint unsigned not null auto_increment primary key comment "Идентификатор региона",
	name varchar(200) not null unique comment "Название региона",
	created_at datetime default current_timestamp comment "Время создания строки", 
	updated_at datetime default current_timestamp on update current_timestamp comment "Время обновления строки"
) comment "Регионы";

-- Таблица районов
create table if not exists districts (
	id smallint unsigned not null auto_increment primary key comment "Идентификатор района",
	name varchar(200) not null unique comment "Название района",
	created_at datetime default current_timestamp comment "Время создания строки", 
	updated_at datetime default current_timestamp on update current_timestamp comment "Время обновления строки"
) comment "Районы";

-- Таблица населенных пунктов
create table if not exists localities (
	id smallint unsigned not null auto_increment primary key comment "Идентификатор н/п",
	name varchar(200) not null comment "Название н/п",
	region_id tinyint unsigned not null comment "Регион", 
	district_id smallint unsigned not null comment "Район", 
	created_at datetime default current_timestamp comment "Время создания строки", 
	updated_at datetime default current_timestamp on update current_timestamp comment "Время обновления строки"
) comment "Населенные пункты";
show tables;
drop table postcodes;
	